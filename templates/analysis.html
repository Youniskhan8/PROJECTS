<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Commodity Analysis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='analysis_style.css') }}">

</head>
<body>
    <a href="/home" class="nav-btn">üè† Back to Home</a>

<div class="container">
    <h2>Commodity Price Prediction</h2>

    <label>Commodity:</label>
    <select id="commodity">
        {% for item in dropdowns['commodities'] %}
            <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
    </select><br><br>

    <label>Variety:</label>
    <select id="variety">
        {% for item in dropdowns['varieties'] %}
            <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
    </select><br><br>

    <label>Grade:</label>
    <select id="grade">
        {% for item in dropdowns['grades'] %}
            <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
    </select><br><br>

    <label>District Name:</label>
    <select id="district">
        {% for item in dropdowns['districts'] %}
            <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
    </select><br><br>

    <label>Market Name:</label>
    <select id="market">
        {% for item in dropdowns['markets'] %}
            <option value="{{ item }}">{{ item }}</option>
        {% endfor %}
    </select><br><br>

    <label>Price Date:</label>
    <input type="date" id="priceDate"><br><br>

    <label>Temperature:</label>
    <input type="number" id="temperature" step="0.1"><br><br>

    <button onclick="predictPrice()">Predict Price</button>

    <h3 id="result"></h3>
</div>


<script>
    async function predictPrice() {
        const data = {
            "Commodity": document.getElementById("commodity").value,
            "Variety": document.getElementById("variety").value,
            "Grade": document.getElementById("grade").value,
            "District Name": document.getElementById("district").value,
            "Market Name": document.getElementById("market").value,
            "Price Date": document.getElementById("priceDate").value,
            "Temperature": parseFloat(document.getElementById("temperature").value)
        };

        const response = await fetch("http://127.0.0.1:5001/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        document.getElementById("result").innerText =
            result["Predicted Modal Price"]
            ? "Predicted Price: ‚Çπ" + result["Predicted Modal Price"]
            : "Error: " + result["error"];
    }
</script>
</body>
</html>
